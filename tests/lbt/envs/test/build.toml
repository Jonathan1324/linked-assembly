[project]
name = "TestProject"
version = "0.1.0"
description = "A test project to test this buildtool"

[build]
dir = "build"
default_target = "build"

[tools]
default_toolchain = "default"
default_mode = "debug"
toolchains = ["toolchains.yaml"]
formats = ["formats.yaml"]

[targets.run]
description = "Run the project"
before = ["build"]
run = "execute ${BUILD_DIR}/main"

[targets.build]
description = "Build the project"
out = "executable"
out_path = "main"
depends = ["compile_src", "lib", "compile_windows_srcs", "compile_linux_srcs", "compile_macos_srcs"]
message = "Building the project"

[targets.compile_src]
description = "Compile files in src"
out = "object"
path = "src/exe"
files = "*.c"
out_path = "exe/${INPUT}.o"

[targets.lib]
description = "Link the static library"
out = "static-library"
out_path = "libcore.a"
depends = ["compile_lib_srcs"]
message = "Building the library"

[targets.compile_lib_srcs]
description = "Compile sources in src/lib"
out = "object"
path = "src/lib"
files = "*.c"
out_path = "lib/${INPUT}.o"

[targets.compile_windows_srcs]
os = ["windows"]
out = "object"
path = "src/windows"
files = "*.c"
out_path = "windows/${INPUT}.o"

[targets.compile_linux_srcs]
os = ["linux"]
out = "object"
path = "src/linux"
files = "*.c"
out_path = "linux/${INPUT}.o"

[targets.compile_macos_srcs]
os = ["macos"]
out = "object"
path = "src/macos"
files = "*.c"
out_path = "macos/${INPUT}.o"

[targets.clean]
description = "Clean the project"
run = "delete ${BUILD_DIR}"
