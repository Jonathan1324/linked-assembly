config:
  default_env: general
  default_targets:
  - test

toolchains:
  myToolchain:
    description: This is a test toolchain

    tools:
      CC:
        type: compiler
        when:
          ext:
          - c
          type: source
        command: gcc -c ${ INPUT } -o ${ OUTPUT }
        message: Compiling ${ INPUT }
      LD:
        type: linker
        when:
          type: object
        command: gcc ${ INPUT } -o ${ OUTPUT }
        message: Linking ${ OUTPUT }

environments:
  general:
    description: This is the general environment
    toolchain: myToolchain
    vars:
      SRC_DIR: src
      BUILD_DIR: build

targets:
  test:
    path: ${ $env.SRC_DIR }
    config: build.yaml
    # target gets defaulted to 'main'
    outputs:
      main:
        type: executable
    env: general
